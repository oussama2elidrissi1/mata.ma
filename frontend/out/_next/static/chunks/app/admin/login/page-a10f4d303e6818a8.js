(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5920],{2775:function(e,t,r){Promise.resolve().then(r.bind(r,4507))},4507:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var a=r(7437),n=r(2265),s=r(9376),o=r(6337),c=r(2252),l=r(9345),i=r(9090),d=r(6023);function u(){let e=(0,s.useRouter)(),[t,r]=(0,n.useState)(""),[u,m]=(0,n.useState)(""),[h,x]=(0,n.useState)(!1),[f,p]=(0,n.useState)(""),[g,y]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let t=setTimeout(()=>{if((0,d.$8)()){let t=(0,d.ts)();(null==t?void 0:t.role)==="admin"?e.replace("/admin"):e.replace("/actor/dashboard")}else y(!1)},100);return()=>clearTimeout(t)},[e]);let b=async r=>{r.preventDefault(),p(""),x(!0);try{let r=await (0,d.x4)(t,u);if(r.success){if("admin"!==r.data.user.role){p("Acc\xe8s r\xe9serv\xe9 aux administrateurs");return}e.push("/admin")}else p(r.message||"Erreur de connexion")}catch(e){var a,n;p((null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.message)||"Les identifiants fournis sont incorrects.")}finally{x(!1)}};return g?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-amber-700 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-white",children:"Chargement..."})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-blue-700 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"max-w-md w-full",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center gap-3 mb-4",children:(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("span",{className:"text-4xl font-bold text-red-500 tracking-tight",style:{textShadow:"2px 2px 4px rgba(0,0,0,0.3), -1px -1px 2px rgba(255,255,255,0.2)",letterSpacing:"-0.02em"},children:"MATA"})})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-1",children:"Administration"}),(0,a.jsx)("p",{className:"text-sm text-blue-200",children:"Espace de gestion"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl p-8 border border-gray-200",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-900 rounded-full mb-4",children:(0,a.jsx)(o.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Connexion Admin"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Acc\xe9dez \xe0 l'administration MATA"})]}),f&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border-2 border-red-200 rounded-lg flex items-start gap-3",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,a.jsx)("p",{className:"text-sm text-red-600 font-medium",children:f})]}),(0,a.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Adresse email"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(l.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{id:"email",type:"email",required:!0,value:t,onChange:e=>r(e.target.value),placeholder:"admin@mata.ma",className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-900 focus:border-blue-900 transition-all text-gray-900 bg-white"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Mot de passe"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(o.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{id:"password",type:"password",required:!0,value:u,onChange:e=>m(e.target.value),placeholder:"••••••••",className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-900 focus:border-blue-900 transition-all text-gray-900 bg-white"})]})]}),(0,a.jsx)("button",{type:"submit",disabled:h,className:"w-full py-3 bg-blue-900 text-white rounded-xl hover:bg-blue-800 transition-colors font-semibold shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),(0,a.jsx)("span",{children:"Connexion..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Se connecter"})]})})]}),(0,a.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,a.jsxs)("p",{className:"text-xs text-center text-gray-500",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Identifiants par d\xe9faut :"})," admin@mata.ma / admin123"]})})]})]})})}},9116:function(e,t,r){"use strict";r.d(t,{Bt:function(){return l},aL:function(){return i},eJ:function(){return c},jB:function(){return u},kN:function(){return m},sZ:function(){return s},wL:function(){return n},yM:function(){return o},zX:function(){return d}});let a=r(3464).Z.create({baseURL:"http://localhost:8000/api",headers:{Accept:"application/json"},withCredentials:!0});{let e=localStorage.getItem("auth_token");e&&(a.defaults.headers.common.Authorization="Bearer ".concat(e))}a.interceptors.request.use(e=>{{let t=localStorage.getItem("auth_token");t&&(e.headers.Authorization="Bearer ".concat(t)),e.data instanceof FormData&&delete e.headers["Content-Type"]}return e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),localStorage.removeItem("token"),localStorage.removeItem("user"),delete a.defaults.headers.common.Authorization),Promise.reject(e)});let n=async e=>{try{let t="/tourism-actors".concat(e?"?".concat(e):"");console.log("Fetching from URL:",a.defaults.baseURL+t);let r=await a.get(t);if(console.log("API Response:",r.data),r.data.success&&Array.isArray(r.data.data))return r.data.data;return console.warn("Unexpected response format:",r.data),[]}catch(e){throw console.error("Error fetching actors:",e),e.response&&console.error("Response error:",e.response.data),e}},s=async e=>{try{let t=await a.get("/events".concat(e?"?".concat(e):""));if(t.data.success&&Array.isArray(t.data.data))return t.data.data;return[]}catch(e){throw console.error("Error fetching events:",e),e}},o=async e=>{try{return(await a.post("/events",e)).data.data}catch(e){throw console.error("Error creating event:",e),e}},c=async(e,t)=>{try{return(await a.put("/events/".concat(e),t)).data.data}catch(e){throw console.error("Error updating event:",e),e}},l=async e=>{try{await a.delete("/events/".concat(e))}catch(e){throw console.error("Error deleting event:",e),e}},i=async e=>{try{let t=await a.get("/news".concat(e?"?".concat(e):""));if(t.data.success&&Array.isArray(t.data.data))return t.data.data;return[]}catch(e){throw console.error("Error fetching news:",e),e}},d=async e=>{try{return(await a.post("/news",e)).data.data}catch(e){throw console.error("Error creating news:",e),e}},u=async(e,t)=>{try{console.log("Updating news with FormData:",e),t.has("_method")||t.append("_method","PUT");let r=await a.post("/news/".concat(e),t);if(console.log("Update response:",r.data),r.data.success)return r.data.data;throw Error(r.data.message||"Erreur lors de la mise \xe0 jour")}catch(e){throw console.error("Error updating news:",e),e.response&&(console.error("Error response status:",e.response.status),console.error("Error response data:",e.response.data)),e}},m=async e=>{try{await a.delete("/news/".concat(e))}catch(e){throw console.error("Error deleting news:",e),e}};t.ZP=a},6023:function(e,t,r){"use strict";r.d(t,{$8:function(){return l},Z5:function(){return i},bW:function(){return c},kS:function(){return s},ts:function(){return o},x4:function(){return n}});var a=r(9116);let n=async(e,t)=>{try{let r=await a.ZP.post("/auth/login",{email:e,password:t});return r.data.success&&r.data.data.token&&(localStorage.setItem("auth_token",r.data.data.token),localStorage.setItem("auth_user",JSON.stringify(r.data.data.user)),a.ZP.defaults.headers.common.Authorization="Bearer ".concat(r.data.data.token)),r.data}catch(e){throw console.error("Login error:",e),e}},s=async()=>{try{await a.ZP.post("/auth/logout")}catch(e){console.error("Logout error:",e)}finally{localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),delete a.ZP.defaults.headers.common.Authorization}},o=()=>{let e=localStorage.getItem("auth_user");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}},c=()=>localStorage.getItem("auth_token"),l=()=>!!c(),i=()=>{let e=c();e&&(a.ZP.defaults.headers.common.Authorization="Bearer ".concat(e))}},9763:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var a=r(2265),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),o=(e,t)=>{let r=(0,a.forwardRef)((r,o)=>{let{color:c="currentColor",size:l=24,strokeWidth:i=2,absoluteStrokeWidth:d,className:u="",children:m,...h}=r;return(0,a.createElement)("svg",{ref:o,...n,width:l,height:l,stroke:c,strokeWidth:d?24*Number(i)/Number(l):i,className:["lucide","lucide-".concat(s(e)),u].join(" "),...h},[...t.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(m)?m:[m]])});return r.displayName="".concat(e),r}},2252:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6337:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},9090:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]])},9345:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[3464,2971,2117,1744],function(){return e(e.s=2775)}),_N_E=e.O()}]);